<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=620px,initial-scale=1,target-densitydpi=device-dpi,minimum-scale=1,maximum-scale=1,user-scalable=1" />  
    <meta name="product" content="Metro UI CSS Framework">
    <meta name="description" content="Simple responsive css framework">

    <link href="css/metro-bootstrap.css" rel="stylesheet">
    <link href="css/metro-bootstrap-responsive.css" rel="stylesheet">
    <link href="css/iconFont.css" rel="stylesheet">
    <link href="css/docs.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <link href="js/prettify/prettify.css" rel="stylesheet">

    <!-- Load JavaScript Libraries -->
    <script src="js/jquery/jquery.min.js"></script>
    <script src="js/jquery/jquery.widget.min.js"></script>
    <script src="js/jquery/jquery.mousewheel.js"></script>
    <script src="js/prettify/prettify.js"></script>
    <script src="js/holder/holder.js"></script>

    <!-- Metro UI CSS JavaScript plugins -->
    <script src="js/load-metro.js"></script>
	<script src="js/common.js"></script>

    <!-- Local JavaScript -->

    <title>职位信息</title>
</head>
<body class="metro">

    <nav class="navigation-bar dark">
        <div class="navigation-bar-content">
            <a href="/" class="element"><span class="icon-grid-view"></span> 可信社区 <sup>1.0</sup></a>
            <span class="element-divider"></span>

            <a class="pull-menu" href="#"></a>
            <ul class="element-menu">
                <li>
                    <a class="dropdown-toggle" href="#">社区公告</a>
                    <ul class="dropdown-menu dark" data-role="dropdown">
                        <li><a href="Announcement.html">公告浏览</a></li>
                        <li class="disabled"><a href="#">公告管理</a></li>
                    </ul>
                </li>
                <li>
                    <a class="dropdown-toggle"  href="Neighbour.html">左邻右舍</a>
                </li>
                <li>
                    <a class="dropdown-toggle"  href="Committee.html">居委会</a>
                </li>
            </ul>

            <div class="no-tablet-portrait">
                <span class="element-divider"></span>
                <a class="element brand" href="#"><span class="icon-spin"></span></a>
                <a class="element brand" href="#"><span class="icon-printer"></span></a>
                <span class="element-divider"></span>

                <div class="element input-element">
                    <form>
                        <div class="input-control text">
                            <input type="text" placeholder="Search...">
                            <button class="btn-search"></button>
                        </div>
                    </form>
                </div>

                <div class="element place-right">
                    <a class="dropdown-toggle" href="#">
                        <span class="icon-cog"></span>
                    </a>
                    <ul class="dropdown-menu place-right" data-role="dropdown">
                        <li><a href="#">更改个人信息</a></li>
                    </ul>
                </div>
                <span class="element-divider place-right"></span>
                <button class="element image-button image-left place-right">
                    我
                    <img src="images/me.jpg"/>
                </button>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1>
            <a href="/"><i class="icon-arrow-left-3 fg-darker smaller"></i></a>
          	  <span class="position-name">{职位名称}</span><small class="on-right"></small>
        </h1>

        <h3>
            <strong>姓名: </strong><span class="username">{name}</span>
        </h3>

        <div class="person-list">
            <div style="margin-top: 20px" class="person-list-container">
            </div>
        </div>

        <div class="container">
            <h3><strong>职位描述：</strong></h3>
            <p class="description">这里是职位描述</p>
        </div>

        <div style="margin-top:30px">
            <a class="button large default fg-white contactme" target="_blank" href="#">发信息</a>
        </div>


    </div> <!-- End of container -->

    <script src="js/hitua.js"></script>
    <script type="text/javascript">
    if (!String.prototype.format) {
      String.prototype.format = function() {
        var args = arguments;
        return this.replace(/{(\d+)}/g, function(match, number) { 
          return typeof args[number] != 'undefined'
            ? args[number]
            : match
          ;
        });
      };
    }

    function getQueryVariable(variable) {
      var query = window.location.search.substring(1);
      var vars = query.split("&");
      for (var i=0;i<vars.length;i++) {
        var pair = vars[i].split("=");
        if (pair[0] == variable) {
          return pair[1];
        }
      } 
      return '';
    }


	(function($){
        var userid = getQueryVariable('user_id');
        var roleid = getQueryVariable('role_id');
        $.ajax({
            type: "GET",
            url: 'rest/users/id/' + userid,
            success: function(data) {
                var name = data.username;
                $('.username').text(name);
                var position = $(data.roles).filter(function(i, d) {return d.id == roleid;})[0];

                var html = 
                    '<div class="image-container shadow">' +
                    '<img src="images/{0}" class=""></a>'.format(data.imageUrl) +
                    '</div>';
                $('.person-list-container').append($(html));
                $('.description').text(position.description);
                $('.position-name').text(position.name);
            },
            error: function(obj) {
                console.log(obj);
            }
        });

        $('.contactme').attr('href', 'mailbox.html#sendtoid='+userid);
        })(jQuery);
	</script>

</body>
</html>